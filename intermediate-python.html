<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Workshop Notes – intermediate-python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Workshop Notes</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./intermediate-git.html">
 <span class="menu-text">Intermediate Git</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./intermediate-python.html" aria-current="page">
 <span class="menu-text">Intermediate Python</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./debugging/intro.html">
 <span class="menu-text">Debugging</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#intermediate-python" id="toc-intermediate-python" class="nav-link active" data-scroll-target="#intermediate-python">Intermediate Python</a>
  <ul class="collapse">
  <li><a href="#exceptions-context-managers" id="toc-exceptions-context-managers" class="nav-link" data-scroll-target="#exceptions-context-managers">Exceptions &amp; Context Managers</a>
  <ul class="collapse">
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#exceptions-syntax-review" id="toc-exceptions-syntax-review" class="nav-link" data-scroll-target="#exceptions-syntax-review">Exceptions Syntax Review</a></li>
  <li><a href="#context-managers" id="toc-context-managers" class="nav-link" data-scroll-target="#context-managers">Context Managers</a></li>
  <li><a href="#writing-your-own-context-managers" id="toc-writing-your-own-context-managers" class="nav-link" data-scroll-target="#writing-your-own-context-managers">Writing Your Own Context Managers</a></li>
  <li><a href="#tips-further-reading" id="toc-tips-further-reading" class="nav-link" data-scroll-target="#tips-further-reading">Tips / Further Reading</a></li>
  </ul></li>
  <li><a href="#generators" id="toc-generators" class="nav-link" data-scroll-target="#generators">Generators</a>
  <ul class="collapse">
  <li><a href="#iterables" id="toc-iterables" class="nav-link" data-scroll-target="#iterables">Iterables</a></li>
  <li><a href="#motivation-for-generators" id="toc-motivation-for-generators" class="nav-link" data-scroll-target="#motivation-for-generators">Motivation for Generators</a></li>
  <li><a href="#generators-1" id="toc-generators-1" class="nav-link" data-scroll-target="#generators-1">Generators</a></li>
  <li><a href="#generator-expressions" id="toc-generator-expressions" class="nav-link" data-scroll-target="#generator-expressions">Generator Expressions</a></li>
  <li><a href="#itertools" id="toc-itertools" class="nav-link" data-scroll-target="#itertools"><code>itertools</code></a></li>
  </ul></li>
  <li><a href="#typing" id="toc-typing" class="nav-link" data-scroll-target="#typing">Typing</a>
  <ul class="collapse">
  <li><a href="#motivation-1" id="toc-motivation-1" class="nav-link" data-scroll-target="#motivation-1">Motivation</a></li>
  <li><a href="#static-typing" id="toc-static-typing" class="nav-link" data-scroll-target="#static-typing">Static Typing</a></li>
  <li><a href="#type-annotations" id="toc-type-annotations" class="nav-link" data-scroll-target="#type-annotations">Type Annotations</a></li>
  <li><a href="#types" id="toc-types" class="nav-link" data-scroll-target="#types">Types</a></li>
  <li><a href="#type-checking" id="toc-type-checking" class="nav-link" data-scroll-target="#type-checking">Type Checking</a></li>
  <li><a href="#runtime-type-checking" id="toc-runtime-type-checking" class="nav-link" data-scroll-target="#runtime-type-checking">Runtime Type Checking</a></li>
  <li><a href="#more-on-types" id="toc-more-on-types" class="nav-link" data-scroll-target="#more-on-types">More on Types</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a>
  <ul class="collapse">
  <li><a href="#more-python" id="toc-more-python" class="nav-link" data-scroll-target="#more-python">More Python</a></li>
  <li><a href="#next-time-interactive-debugging-lab" id="toc-next-time-interactive-debugging-lab" class="nav-link" data-scroll-target="#next-time-interactive-debugging-lab">Next Time: Interactive Debugging Lab</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="intermediate-python" class="level1">
<h1>Intermediate Python</h1>
<p>Today we’re going to be talking about some features of Python that might be considered “ergonomic.”</p>
<p>You can, and have, gotten by without using these as they aren’t fundamental in the way that loops, functions, and classes are.</p>
<p>Learning these features gives you additional ways to solve problems, which can be more efficient or elegant than alternatives.</p>
<p>Some topics that fall into this category are:</p>
<ul>
<li>Comprehensions (which you’ve already seen)</li>
<li>Decorators (which you’ve seen a little bit of)</li>
<li>Exceptions &amp; Context Managers</li>
<li>Generators</li>
<li>Type Hints</li>
</ul>
<section id="exceptions-context-managers" class="level2">
<h2 class="anchored" data-anchor-id="exceptions-context-managers">Exceptions &amp; Context Managers</h2>
<section id="motivation" class="level3">
<h3 class="anchored" data-anchor-id="motivation">Motivation</h3>
<p>No matter how good your code is, there’s always going to be a chance that something goes wrong.</p>
<p>A common example is a file not being available when you try to open it. (Perhaps it is missing or you don’t have permission to access it.)</p>
<p>You could imagine code like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> <span class="bu">open</span>(<span class="st">"file.txt"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.write(<span class="st">"Hello, world!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.write(<span class="st">"Second Write"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you’re worried about <code>open</code> failing you might end up with code like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> <span class="bu">open</span>(<span class="st">"file.txt"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># check if file is open (not a real method, just an example)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">file</span>.is_open():</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.write(<span class="st">"Hello, world!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.write(<span class="st">"Second Write"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>But what if other methods fail? If we’re writing over a network, the disk is full, or the file is locked by another process?</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this code does not work, demo purposes</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> <span class="bu">open</span>(<span class="st">"file.txt"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">file</span>.is_open():</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    success <span class="op">=</span> <span class="bu">file</span>.write(<span class="st">"Hello, world!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> success:</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        success <span class="op">=</span> <span class="bu">file</span>.write(<span class="st">"Second Write"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> success:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle error</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># close file no matter what</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This can get very messy very quickly.</p>
</section>
<section id="exceptions-syntax-review" class="level3">
<h3 class="anchored" data-anchor-id="exceptions-syntax-review">Exceptions Syntax Review</h3>
<p>In Python, we can use exceptions as an alternate control flow path. What this means is that instead of executing code sequentially, we can jump to a different part of the program if an exception is raised.</p>
<p>The two key pieces of syntax are <code>raise</code>, and <code>try-except</code>.</p>
<section id="raise-exception-types" class="level4">
<h4 class="anchored" data-anchor-id="raise-exception-types"><code>raise</code> &amp; Exception Types</h4>
<p>When a <code>raise</code> statement is encountered, typical execution is stopped and the program jumps to the nearest matching <code>except</code> block.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">raise</span> ExceptionType(<span class="st">"message"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>An exception can be any class that inherits from <code>BaseException</code>, common built in exceptions are:</p>
<ul>
<li><code>Exception</code></li>
<li><code>ValueError</code></li>
<li><code>TypeError</code></li>
<li><code>KeyError</code></li>
<li><code>IndexError</code></li>
<li><code>FileNotFoundError</code></li>
<li><code>NotImplementedError</code></li>
</ul>
<p>You can also create your own by subclassing <code>Exception</code> or any other relevant type.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TooManyTokens(<span class="pp">Exception</span>):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(tokens) <span class="op">&gt;</span> MAX_TOKENS:</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> TooManyTokens(<span class="ss">f"Expected at most </span><span class="sc">{</span>MAX_TOKENS<span class="sc">}</span><span class="ss"> tokens, got </span><span class="sc">{</span><span class="bu">len</span>(tokens)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="try-except" class="level4">
<h4 class="anchored" data-anchor-id="try-except"><code>try-except</code></h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># code that might raise an exception</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> ExceptionType:</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># code to run if an exception is raised</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> OtherExceptionType <span class="im">as</span> e:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># code to run if an exception is raised</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># in this example, e will be the exception object so you can</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># use it/log it/etc.</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># code to run if no exception is raised</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># code to run no matter what</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>only one <code>except</code> block will be run, the first one that matches the exception type</li>
<li>an <code>except</code> block can match multiple exception types by providing a tuple of types or by using a base class</li>
<li><code>else</code> and <code>finally</code> are not required and often omitted, but can be useful.</li>
</ul>
<p>Our file handling example can be rewritten to use exceptions:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span> <span class="op">=</span> <span class="bu">open</span>(<span class="st">"file.txt"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.write(<span class="st">"Hello, world!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.write(<span class="st">"Second Write"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">OSError</span>, <span class="pp">IOError</span>) <span class="im">as</span> e:</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># handle error</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now if any of these three lines raise an exception, the file will still be closed.</p>
</section>
</section>
<section id="context-managers" class="level3">
<h3 class="anchored" data-anchor-id="context-managers">Context Managers</h3>
<p>Context managers are a way to automatically run some code when entering and exiting a block of code.</p>
<p>They are commonly used to manage resources like files, locks, and database connections and can be thought of as related to exceptions in that they provide an alternate way to work with errors.</p>
<p>If a Python object has <code>__enter__</code> and <code>__exit__</code> methods, it can be used as a context manager.</p>
<p>Rewriting our file handling example to use a context manager:</p>
<p><code>__enter__</code> is called when entering the <code>with</code> block, and <code>__exit__</code> is called when exiting the block.</p>
<p>These are called no matter what, so if an exception is raised, <code>__exit__</code> will still be called.</p>
<p>If you have no custom code you need to run, just want to make sure something is closed, you could rewrite the above example as</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"file.txt"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.write(<span class="st">"Hello, world!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.write(<span class="st">"Second Write"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Any exception raised in the <code>with</code> block will be caught and passed to <code>__exit__</code>. <code>file's</code> <code>__exit__</code> method will then close the file.</p>
<p>Other common uses of context managers are:</p>
<ul>
<li><code>with db_connection:</code> - Ensures database connection is closed when the block exits.</li>
<li><code>with db.transaction.atomic():</code> - Ensure that a block of code is run within a database transaction so changes can be rolled back if an exception is raised.</li>
</ul>
</section>
<section id="writing-your-own-context-managers" class="level3">
<h3 class="anchored" data-anchor-id="writing-your-own-context-managers">Writing Your Own Context Managers</h3>
<p>As mentioned, if a Python object has <code>__enter__</code> and <code>__exit__</code> methods, it can be used as a context manager.</p>
<p>You can write your own context managers by implementing these methods.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyContextManager:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__enter__</span>(<span class="va">self</span>):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"entering block"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># code to run when entering the block</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># return value is assigned to the variable in the `as` clause</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__exit__</span>(<span class="va">self</span>, exc_type, exc_value, traceback):</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># code to run when exiting the block</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># exc_type, exc_value, and traceback are the exception info</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if an exception was raised, otherwise they are None</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> exc_type <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"exception was raised"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"exiting normally"</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># return True to suppress the exception propagating</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> MyContextManager() <span class="im">as</span> context:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"inside block"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>entering block
inside block
exiting normally</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> MyContextManager() <span class="im">as</span> context:</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span> <span class="op">/</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>entering block
exception was raised</code></pre>
</div>
</div>
</section>
<section id="tips-further-reading" class="level3">
<h3 class="anchored" data-anchor-id="tips-further-reading">Tips / Further Reading</h3>
<ul>
<li><p>Try to keep your <code>try</code> blocks as small as possible, only including the code that might raise an exception.</p></li>
<li><p>Catch the most specific exception possible, and only catch exceptions that you can handle.</p></li>
<li><p>Avoid catching <code>Exception</code>, or omitting the exception type entirely. This will catch all exceptions, which can lead to hard-to-find bugs.</p></li>
<li><p><a href="https://docs.python.org/3/tutorial/errors.html">Python Docs - Errors and Exceptions</a></p></li>
<li><p><a href="https://docs.python.org/3/reference/datamodel.html#context-managers">Python Docs - Context Managers</a></p></li>
<li><p><a href="https://docs.python.org/3/reference/compound_stmts.html#the-with-statement">Python Docs - with Statement</a></p></li>
</ul>
</section>
</section>
<section id="generators" class="level2">
<h2 class="anchored" data-anchor-id="generators">Generators</h2>
<p>Generators are a special type of function that can be re-entered.</p>
<p>An incredibly powerful tool for writing efficient code, especially when dealing with large amounts of data.</p>
<section id="iterables" class="level3">
<h3 class="anchored" data-anchor-id="iterables">Iterables</h3>
<p>Recall that Python objects use dunder methods to implement most of their functionality.</p>
<p>You may recall that when implementing a class you can define <code>__getitem__</code> and <code>__setitem__</code> to make your class subscriptable.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ll <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ll[<span class="dv">0</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ll.<span class="fu">__getitem__</span>(<span class="dv">0</span>))  <span class="co"># you wouldn't write this, but it's the same thing</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ll[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>ll.<span class="fu">__setitem__</span>(<span class="dv">0</span>, <span class="dv">4</span>)  <span class="co"># you wouldn't write this, but it's the same thing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
1</code></pre>
</div>
</div>
<p>A <code>for</code> loop is similarly syntactic sugar for calling two other methods: <code>__iter__</code> and <code>__next__</code>.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ll <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ll:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(item)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
2
3
4</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ll <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>iterator <span class="op">=</span> ll.<span class="fu">__iter__</span>()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        item <span class="op">=</span> iterator.<span class="fu">__next__</span>()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">StopIteration</span>:</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(item)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
2
3
4</code></pre>
</div>
</div>
<ul>
<li><code>__iter__</code> returns an iterator object, a special intermediary object that tracks the current position in the iterable.</li>
<li><code>__next__</code> returns the next item in the iterable, and raises <code>StopIteration</code> when there are no more items.</li>
</ul>
<p>You could write your own classes that implement these methods to make them iterable. But today we’ll look at another way to make iterables: generators.</p>
</section>
<section id="motivation-for-generators" class="level3">
<h3 class="anchored" data-anchor-id="motivation-for-generators">Motivation for Generators</h3>
<p>Let’s say that you want to write a function that will return many values, but you only intend for one to be used at a time.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> permute(word):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(word) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [word]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> []</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(word)):</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> perm <span class="kw">in</span> permute(word[:i] <span class="op">+</span> word[i <span class="op">+</span> <span class="dv">1</span> :]):</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                result.append(word[i] <span class="op">+</span> perm)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>permute(<span class="st">"abc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>['abc', 'acb', 'bac', 'bca', 'cab', 'cba']</code></pre>
</div>
</div>
<p>Great, but the size of the returned list will be <span class="math inline">\(n!\)</span>, where <span class="math inline">\(n\)</span> is the length of the string.</p>
<p>It’s also possible we’re searching for a particular permutation, so we won’t actually need all of the results &amp; it’d be nice to stop early.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> permute(<span class="st">"too long"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(results))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>40320</code></pre>
</div>
</div>
</section>
<section id="generators-1" class="level3">
<h3 class="anchored" data-anchor-id="generators-1">Generators</h3>
<p>Often, we only need one item at a time, and we don’t want to store all of the results in memory.</p>
<p>This is the case with a lot of data processing tasks, where we might have millions of records, but only need to process one at a time.</p>
<p>Generators are special functions that return an iterator.</p>
<p>Let’s take a look at <code>range</code>:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stop_cond(x):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># contrived stop condition, perhaps you're searching for a value that fits some criteria:w</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">==</span> <span class="dv">17</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10_000_000</span>):</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we don't actually need all of the values</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_cond(x):</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"found it!"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
found it!</code></pre>
</div>
</div>
<p>If <code>range</code> returned a list, it would need to allocate a large list, which is both slower and more memory intensive.</p>
<p>Instead range’s implementation looks something like this:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simplified form with one parameter</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="bu">range</span>(n):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&lt;</span> n:</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> i</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>yield</code> is a special keyword that returns a value from the function, but doesn’t exit the function the way <code>return</code> does.</p>
<p>When the function is called again, it will continue from where it left off.</p>
<p>Let’s rewrite <code>permute</code> as a generator:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ipermute(word):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(word) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> word</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(word)):</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> perm <span class="kw">in</span> permute(word[:i] <span class="op">+</span> word[i <span class="op">+</span> <span class="dv">1</span> :]):</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> word[i] <span class="op">+</span> perm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> perm <span class="kw">in</span> ipermute(<span class="st">"abc"</span>):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(perm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>abc
acb
bac
bca
cab
cba</code></pre>
</div>
</div>
</section>
<section id="generator-expressions" class="level3">
<h3 class="anchored" data-anchor-id="generator-expressions">Generator Expressions</h3>
<p>You can use generator expressions to create generators without having to write a function.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>squares <span class="op">=</span> (x<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This looks like a list comprehension, but has parentheses instead of brackets.</p>
<p>It creates a generator that will return the squares of the numbers from 0 to 999999.</p>
</section>
<section id="itertools" class="level3">
<h3 class="anchored" data-anchor-id="itertools"><code>itertools</code></h3>
<p>The <code>itertools</code> module contains many useful functions for working with iterators, all of which are implemented as generators.</p>
<p>Useful functions include:</p>
<ul>
<li><code>itertools.permutations</code> - permutations of an iterable</li>
<li><code>itertools.combinations</code> - combinations without replacement</li>
<li><code>itertools.product</code> - cartesian product of multiple iterables (like nested for loops)</li>
<li><code>itertools.chain</code> - concatenate iterators</li>
<li><code>itertools.islice</code> - slice an iterator the way you would a list</li>
<li><code>itertools.groupby</code> - group items by a key</li>
<li><code>itertools.tee</code> - create multiple iterators from one</li>
</ul>
</section>
</section>
<section id="typing" class="level2">
<h2 class="anchored" data-anchor-id="typing">Typing</h2>
<p>The biggest change to Python in recent years is the addition of type annotations.</p>
<section id="motivation-1" class="level3">
<h3 class="anchored" data-anchor-id="motivation-1">Motivation</h3>
<p>Python is a dynamically typed language, which means that the type of a variable is determined at runtime.</p>
<p>It also means the type can change:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="st">"hello"</span>  <span class="co"># no error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is a common source of bugs, since it can be difficult to keep track of what type a variable is.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> f() <span class="co"># f used to return an int, but now returns a string</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="static-typing" class="level3">
<h3 class="anchored" data-anchor-id="static-typing">Static Typing</h3>
<p>Many languages require variable definitions and function signatures to include type annotations.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">// C</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> f<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode rust code-with-copy"><code class="sourceCode rust"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Rust</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> f(x<span class="op">:</span> <span class="dt">i32</span>) <span class="op">-&gt;</span> <span class="dt">i32</span> <span class="op">{</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is called static typing, because the type is checked at compile time.</p>
</section>
<section id="type-annotations" class="level3">
<h3 class="anchored" data-anchor-id="type-annotations">Type Annotations</h3>
<p>Python 3.5 introduced type annotations, which are optional type hints that can be added to your code. Evey version of Python since 3.5 has added new features to the type system, but as of 3.10 many of the rough edges have been smoothed out.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Two new pieces of syntax:</p>
<ul>
<li>After a variable definition (typically a function parameter) you can add a colon and the type.</li>
<li>Return type annotations can be placed after the closing parenthesis of the function signature with the <code>-&gt; int</code> syntax.</li>
</ul>
</section>
<section id="types" class="level3">
<h3 class="anchored" data-anchor-id="types">Types</h3>
<p>You can annotate with any of the built-in types:</p>
<ul>
<li><code>int</code></li>
<li><code>float</code></li>
<li><code>str</code></li>
<li><code>bool</code></li>
<li><code>None</code></li>
<li>etc.</li>
</ul>
<p>The compound types (features added in Python 3.7-3.9):</p>
<ul>
<li><code>list</code></li>
<li><code>dict</code></li>
<li><code>set</code></li>
<li><code>tuple</code></li>
</ul>
<p>These allow for annotating the type of the elements in the container:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x: <span class="bu">list</span>[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="bu">str</span>(i): i <span class="cf">for</span> i <span class="kw">in</span> x}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>list[int]</code> - a list of <code>int</code>s</li>
<li><code>dict[str, int]</code> - a dictionary with <code>str</code> keys and <code>int</code> values</li>
<li><code>tuple[int, str]</code> - a 2-tuple with an <code>int</code> and a <code>str</code></li>
<li><code>set[tuple[int, int, int]]</code> - set of 3-tuples of ints</li>
</ul>
<p>And finally, there are a lot of helper types in the <code>typing</code> module:</p>
<ul>
<li><code>typing.Any</code> - any type</li>
<li><code>typing.Optional[int]</code> - an <code>int</code> or <code>None</code></li>
<li><code>typing.Union[int, str]</code> - an <code>int</code> or a <code>str</code></li>
<li><code>typing.Callable[[int, str], bool]</code> - a function that takes an <code>int</code> and a <code>str</code> and returns a <code>bool</code></li>
</ul>
<p>You can also union types together with <code>|</code> (as of Python 3.10):</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x: <span class="bu">int</span> <span class="op">|</span> <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span> <span class="op">|</span> <span class="bu">str</span>:</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This also works as an alternate syntax for <code>Optional</code>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span>) <span class="op">-&gt;</span> <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span>:</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="type-checking" class="level3">
<h3 class="anchored" data-anchor-id="type-checking">Type Checking</h3>
<p>One thing to be aware of: these don’t do anything! They’re just hints for the programmer.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bad type annotations</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x: <span class="bu">list</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"a"</span>: <span class="dv">1</span>}</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>f(<span class="fl">27.5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Every type annotation is wrong in the above example, but Python will not complain at “compile” time nor at runtime.</p>
<p>If you want to check your types, you can use a tool like <code>mypy</code>:</p>
<p>https://mypy-lang.org/</p>
<p>Running <code>mypy</code> on the above code will give you output like:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>$ mypy test.py</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>test.py:<span class="dv">3</span>: error: Incompatible <span class="cf">return</span> value <span class="bu">type</span> (got <span class="st">"Dict[str, int]"</span>, expected <span class="st">"str"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>test.py:<span class="dv">5</span>: error: Argument <span class="dv">1</span> to <span class="st">"f"</span> has incompatible <span class="bu">type</span> <span class="st">"float"</span><span class="op">;</span> expected <span class="st">"list"</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>Found <span class="dv">2</span> errors <span class="kw">in</span> <span class="dv">1</span> <span class="bu">file</span> (checked <span class="dv">1</span> source <span class="bu">file</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="runtime-type-checking" class="level3">
<h3 class="anchored" data-anchor-id="runtime-type-checking">Runtime Type Checking</h3>
<p>Some libraries, such as the built in <code>dataclasses</code> module, <code>pydantic</code>, <code>FastAPI</code>, and <code>typer</code> are starting to use type annotations for runtime type checking.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(BaseModel):</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>: <span class="bu">int</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    email: <span class="bu">str</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># these are type-checked</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>user <span class="op">=</span> User(<span class="bu">id</span><span class="op">=</span><span class="dv">1</span>, name<span class="op">=</span><span class="st">"Sarah Connor"</span>, email<span class="op">=</span><span class="st">"sarah@hotmail.com"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># note: id will be coerced to string since types are compatible</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    user <span class="op">=</span> User(<span class="bu">id</span><span class="op">=</span><span class="dv">1</span>, name<span class="op">=</span><span class="st">"Sarah Connor"</span>, email<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 validation error for User
email
  none is not an allowed value (type=type_error.none.not_allowed)</code></pre>
</div>
</div>
<p>This allows you to catch errors earlier, and can result in less boilerplate code.</p>
</section>
<section id="more-on-types" class="level3">
<h3 class="anchored" data-anchor-id="more-on-types">More on Types</h3>
<p>You’ll definitely encounter type annotations in library documentation, and in more modern codebases.</p>
<p>Norms around their usage are evolving, but it’s worth getting into the habit of using them. It can make your code more clear and easier to maintain. It can help you find bugs before they happen or more easily reason about expected behavior in an unfamiliar codebase.</p>
<p>More on <code>typing</code>: https://docs.python.org/3/library/typing.html</p>
<p>If you’re using VSCode’s Python extension, it integrates nicely with type extensions and can be configured to warn you about type errors and optionally run tools like <code>mypy</code> to check your types.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>A common symptom of the “intermediate” stage of knowing a language is that people tend to overuse features that are available to them.</p>
<p>Please keep in mind that there’s nothing inherently better about choosing these over the alternatives, strive to make your code readable and maintainable above all else.</p>
<section id="more-python" class="level3">
<h3 class="anchored" data-anchor-id="more-python">More Python</h3>
<ul>
<li>Functional Programming - decorators, <code>functools</code></li>
<li>Metaclasses</li>
<li>Async I/O - <code>asyncio</code>, <code>async/await</code></li>
<li>Bridging Python to other languages - C API, Cython, CFFI, PyO3</li>
</ul>
</section>
<section id="next-time-interactive-debugging-lab" class="level3">
<h3 class="anchored" data-anchor-id="next-time-interactive-debugging-lab">Next Time: Interactive Debugging Lab</h3>
<p>I’ll be sending out some setup instructions in advance, since I’d like the next talk to be more interactive.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>